function onAddDriver(t){getDeliveryDriver(2023,t).then(function(t){createChart(t)}).catch(function(t){})}function getDeliveryDriver(n,r){var t=window.location.href,a=t.substring(0,t.lastIndexOf("/"));return new Promise(function(e,t){$.ajax({type:"POST",url:a+"/Stats/GetStatPerMonthDriver",data:{year:n,matricules:r},success:function(t){e(t)},error:function(){t("Une erreur est survenue lors de la récupération des statistiques du chauffeur")}})})}function recreateGraph(){let t=[];$(".chekbox-driver-stat").each(function(){$(this).is(":checked")&&t.push($(this).data("mat"))}),getDeliveryDriver(2023,t).then(function(t){createChart(t)}).catch(function(t){})}function createChart(t){t=t.map(t=>({label:t.matricule,fill:!0,backgroundColor:"transparent",borderColor:"#"+Math.floor(16777215*Math.random()).toString(16),data:t.statsPerMonth.map(t=>t.count)}));return new Chart(document.getElementById("chartjs-line"),{type:"line",data:{labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:t},options:{scales:{xAxes:[{reverse:!0,gridLines:{color:"rgba(0,0,0,0.05)"}}],yAxes:[{borderDash:[5,5],gridLines:{color:"rgba(0,0,0,0)",fontColor:"#fff"}}]}}})}function refreshTable(){var t;0!=$("#activeRefresh").length&&((t=document.getElementById("activeRefresh")).classList.add("rotate-icon"),$.ajax({url:"/Deliveries/Index",type:"GET",success:function(t){$("#deliveryTable").html(t.find("#deliveryTable"))},error:function(t){console.log("Error:",t)}}),setTimeout(function(){t.classList.remove("rotate-icon")},2e3))}document.addEventListener("DOMContentLoaded",function(){recreateGraph(),$(".chekbox-driver-stat").on("change",function(t){recreateGraph()}),$("#col-mat-stat-driver").on("click",function(t){var e=$("#tboby-stat-driver").children();$("#tboby-stat-driver").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(1)").text(),e=$(e).find("td:eq(1)").text();return t<e?-1:e<t?1:0}),$("#tboby-stat-driver").append(e)}),$("#col-name-stat-driver").on("click",function(t){var e=$("#tboby-stat-driver").children();$("#tboby-stat-driver").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(2)").text(),e=$(e).find("td:eq(2)").text();return t<e?-1:0}),$("#tboby-stat-driver").append(e)}),$("#col-de-stat-driver").on("click",function(t){var e=$("#tboby-stat-driver").children();$("#tboby-stat-driver").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(3)").text(),e=$(e).find("td:eq(3)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-driver").append(e)}),$("#col-de-start-stat-driver").on("click",function(t){var e=$("#tboby-stat-driver").children();$("#tboby-stat-driver").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(4)").text(),e=$(e).find("td:eq(4)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-driver").append(e)}),$("#col-de-end-stat-driver").on("click",function(t){var e=$("#tboby-stat-driver").children();$("#tboby-stat-driver").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(5)").text(),e=$(e).find("td:eq(5)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-driver").append(e)}),$("#driver-seacrh").on("keyup",function(){var t=$(this).val().toLowerCase();$("#tboby-stat-driver tr").each(function(){-1<$(this).find("td:eq(1)").text().toLowerCase().indexOf(t)?$(this).show():$(this).hide()})}),$("#col-companie-client").on("click",function(t){var e=$("#tboby-stat-client").children();$("#tboby-stat-client").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(0)").text(),e=$(e).find("td:eq(0)").text();return t<e?-1:0}),$("#tboby-stat-client").append(e)}),$("#col-livraison-tot-client").on("click",function(t){var e=$("#tboby-stat-client").children();$("#tboby-stat-client").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(1)").text(),e=$(e).find("td:eq(1)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-client").append(e)}),$("#col-livraison-wait-client").on("click",function(t){var e=$("#tboby-stat-client").children();$("#tboby-stat-client").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(2)").text(),e=$(e).find("td:eq(2)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-client").append(e)}),$("#col-livraison-pross-client").on("click",function(t){var e=$("#tboby-stat-client").children();$("#tboby-stat-client").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(3)").text(),e=$(e).find("td:eq(3)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-client").append(e)}),$("#col-livraison-end-client").on("click",function(t){var e=$("#tboby-stat-client").children();$("#tboby-stat-client").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(4)").text(),e=$(e).find("td:eq(4)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-client").append(e)}),$("#cLient-seacrh").on("keyup",function(){var t=$(this).val().toLowerCase();$("#tboby-stat-client tr").each(function(){-1<$(this).find("td:eq(0)").text().toLowerCase().indexOf(t)?$(this).show():$(this).hide()})}),$("#col-date").on("click",function(t){var e=$("#tboby-stat-date").children();$("#tboby-stat-date").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(0)").text(),e=$(e).find("td:eq(0)").text();return t<e?-1:0}),$("#tboby-stat-date").append(e)}),$("#col-tot-date").on("click",function(t){var e=$("#tboby-stat-date").children();$("#tboby-stat-date").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(1)").text(),e=$(e).find("td:eq(1)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-date").append(e)}),$("#col-start-date").on("click",function(t){var e=$("#tboby-stat-date").children();$("#tboby-stat-date").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(2)").text(),e=$(e).find("td:eq(2)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-date").append(e)}),$("#col-livraison-pross-date").on("click",function(t){var e=$("#tboby-stat-date").children();$("#tboby-stat-date").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(3)").text(),e=$(e).find("td:eq(3)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-date").append(e)}),$("#col-livraison-end-date").on("click",function(t){var e=$("#tboby-stat-date").children();$("#tboby-stat-date").children().remove(),e=e.sort(function(t,e){t=$(t).find("td:eq(4)").text(),e=$(e).find("td:eq(4)").text();return parseInt(t)<parseInt(e)?-1:parseInt(e)>parseInt(t)?1:0}),$("#tboby-stat-date").append(e)})}),$(document).ready(function(){setInterval(refreshTable,3e4)}),document.addEventListener("DOMContentLoaded",function(){var e,n=new Date,t=document.getElementById("prevWeekBtn"),r=document.getElementById("nextWeekBtn"),a=window.location.href,a=a.substring(0,a.lastIndexOf("/"));function o(t,e){var n=new Date(t);n.setDate(n.getDate()-n.getDay()+1);document.querySelector(".calendar-header h3").textContent=n.toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"});for(var r=document.querySelectorAll(".day"),a=0;a<r.length;a++){var d=new Date(n),o=(d.setDate(d.getDate()+a),r[a]),i=o.querySelector(".day-number"),c=o.querySelector("ul");i.textContent=d.toLocaleDateString("fr-FR",{month:"long",day:"numeric"}),c.innerHTML="",e.forEach(function(t){var e,n,r,a,o,i;new Date(Date.parse(t.LoadDate)).toDateString()===d.toDateString()&&((e=document.createElement("li")).textContent="Client: "+t.Client.CompanyName,(n=document.createElement("li")).textContent="Contenu: "+t.Content,(r=document.createElement("li")).textContent="Date de chargement: \n"+new Date(t.LoadDate).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}),(a=document.createElement("li")).textContent="Date de dechargement: \n"+new Date(t.UnloadingDate).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}),(o=document.createElement("a")).setAttribute("href","/Deliveries/Details/"+t.Id),o.textContent="Details",(i=document.createElement("a")).setAttribute("href","/Deliveries/Finish/"+t.Id),i.textContent="Terminer",c.appendChild(e),c.appendChild(n),c.appendChild(r),c.appendChild(a),c.appendChild(o),c.appendChild(i),c.appendChild(document.createElement("hr")))})}}$.ajax({url:a+"/Deliveries/GetDeliveries",type:"GET",dataType:"json",success:function(t){e=t,console.log(t),o(n,e)},error:function(t){console.error("e : "+t)}}),t.addEventListener("click",function(){n.setDate(n.getDate()-7),o(n,e)}),r.addEventListener("click",function(){n.setDate(n.getDate()+7),o(n,e)})}),$(document).ready(function(){var t=document.getElementById("commentField"),e=document.getElementById("reasonSelector");$("#switchButton").click(function(){$(this).hasClass("btn-success")?($(this).removeClass("btn-success").addClass("btn-danger").text("Livraison Ratee"),e.classList.remove("d-none"),t.text="",t.disabled=!0):($(this).removeClass("btn-danger").addClass("btn-success").text("Livraison Effectuee"),e.classList.add("d-none"),t.disabled=!1,t.text="")})});